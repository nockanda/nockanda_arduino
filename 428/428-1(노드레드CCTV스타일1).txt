[{"id":"d5615f4e.c2af","type":"exec","z":"200cf880.993108","command":"","addpay":"payload","append":"","useSpawn":"true","timer":"","oldrc":false,"name":"FFMPEG","x":800,"y":60,"wires":[["385069d4.9fd426"],[],[]]},{"id":"385069d4.9fd426","type":"base64","z":"200cf880.993108","name":"","action":"","property":"payload","x":1020,"y":220,"wires":[["9dde8d8d.8fe52"]]},{"id":"2ec7777b.88d278","type":"ui_template","z":"200cf880.993108","group":"2e57a784.e34818","name":"1채널","order":1,"width":"8","height":"6","format":"<img src={{msg.payload}}>","storeOutMessages":true,"fwdInMessages":false,"resendOnRefresh":true,"templateScope":"local","className":"","x":1510,"y":160,"wires":[[]]},{"id":"9dde8d8d.8fe52","type":"function","z":"200cf880.993108","name":"BASE64전처리","func":"msg.payload = \"data:image/png;base64,\" + msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1200,"y":220,"wires":[["f6235f14.077f4","d5144a30.a76ee8"]]},{"id":"63ed473d.f31308","type":"fs-file-lister","z":"200cf880.993108","name":"","start":"C:\\Users\\wajang\\.node-red\\root\\video","pattern":"*.*","folders":"*","hidden":true,"lstype":"files","path":true,"single":true,"depth":"1","stat":false,"showWarnings":true,"x":420,"y":560,"wires":[["c4020e85.6cfd3"]]},{"id":"6f5e055d.1ff6fc","type":"inject","z":"200cf880.993108","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":210,"y":600,"wires":[["63ed473d.f31308"]]},{"id":"5a5e6e58.af6ba","type":"debug","z":"200cf880.993108","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":690,"y":480,"wires":[]},{"id":"23649fff.914d","type":"ui_list","z":"200cf880.993108","group":"deaca213.3fda1","name":"","order":4,"width":6,"height":7,"lineType":"two","actionType":"click","allowHTML":false,"outputs":1,"topic":"","x":590,"y":600,"wires":[["4488257b.0d750c"]]},{"id":"4488257b.0d750c","type":"ui_template","z":"200cf880.993108","group":"deaca213.3fda1","name":"","order":3,"width":14,"height":12,"format":"<div>\n     <video controls id=\"video\" width=\"100%\" heigth=\"100%\"></video>\n</div>\n\n<script> \n    (function(scope) {\n        scope.$watch('msg', function (msg) {      \n            if (msg) {\n\n                var video = document.getElementById('video');\n                video.src = \"http://192.168.0.8:1880/video/\"+msg.payload.title;\n                video.play();\n            }       \n         }); \n    })(scope); \n</script>","storeOutMessages":false,"fwdInMessages":false,"resendOnRefresh":false,"templateScope":"local","className":"","x":800,"y":660,"wires":[[]]},{"id":"cf92f394.36f48","type":"ui_button","z":"200cf880.993108","name":"","group":"2e57a784.e34818","order":2,"width":"4","height":"1","passthru":false,"label":"재생시작","tooltip":"","color":"","bgcolor":"","className":"","icon":"","payload":"ffmpeg -f rtsp -i \"rtsp://192.168.0.17:8554/mjpeg/1\" -preset slow -codec:v libx264 -pix_fmt yuv420p -b:v 2500k -minrate 1500k -maxrate 4000k -bufsize 5000k -f segment -strftime 1 -segment_time 10 -reset_timestamps 1 \"C:\\Users\\wajang\\.node-red\\root\\video\\ch1\\%Y-%m-%d-%H-%M-%S_steam1.mp4\" -f image2pipe pipe:1","payloadType":"str","topic":"stream1","topicType":"str","x":100,"y":60,"wires":[["4f09cdc1.2fe224"]]},{"id":"a0ac698b.8e4938","type":"ui_button","z":"200cf880.993108","name":"","group":"2e57a784.e34818","order":3,"width":"4","height":"1","passthru":false,"label":"종료","tooltip":"","color":"","bgcolor":"","className":"","icon":"","payload":"SIGTERM","payloadType":"str","topic":"topic","topicType":"msg","x":110,"y":100,"wires":[["3040bc82.0c7e24"]]},{"id":"4096ae81.53c8f","type":"change","z":"200cf880.993108","name":"","rules":[{"t":"set","p":"kill","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":610,"y":100,"wires":[["d5615f4e.c2af"]]},{"id":"cdf9c129.6061e","type":"ui_button","z":"200cf880.993108","name":"","group":"deaca213.3fda1","order":1,"width":5,"height":1,"passthru":false,"label":"목록갱신하기","tooltip":"","color":"","bgcolor":"","className":"","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":180,"y":500,"wires":[["63ed473d.f31308"]]},{"id":"4f09cdc1.2fe224","type":"function","z":"200cf880.993108","name":"msg.payload를제외한나머지를 소거","func":"var data = {\n    topic:msg.topic,\n    payload:msg.payload\n}\n\nreturn data;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":340,"y":60,"wires":[["d5615f4e.c2af"]]},{"id":"3040bc82.0c7e24","type":"function","z":"200cf880.993108","name":"msg.payload를제외한나머지를 소거","func":"var data = {\n    payload:msg.payload\n}\n\nreturn data;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":340,"y":100,"wires":[["4096ae81.53c8f"]]},{"id":"d0b4ec66.ab01d","type":"inject","z":"200cf880.993108","name":"","props":[{"p":"payload.title","v":"2022-02-09-21-57-54_steam1.mp4","vt":"str"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":530,"y":720,"wires":[["4488257b.0d750c"]]},{"id":"21f2a45f.885b3c","type":"ui_template","z":"200cf880.993108","group":"af12f83b.c43ff8","name":"2채널","order":1,"width":"8","height":"6","format":"<img src={{msg.payload}}>","storeOutMessages":true,"fwdInMessages":false,"resendOnRefresh":true,"templateScope":"local","className":"","x":1510,"y":200,"wires":[[]]},{"id":"98d82166.950b1","type":"ui_template","z":"200cf880.993108","group":"e241e0f8.2cb09","name":"3채널","order":1,"width":"8","height":"6","format":"<img src={{msg.payload}}>","storeOutMessages":true,"fwdInMessages":false,"resendOnRefresh":true,"templateScope":"local","className":"","x":1510,"y":240,"wires":[[]]},{"id":"a6b3683f.8caff8","type":"ui_template","z":"200cf880.993108","group":"3bf98549.5a498a","name":"4채널","order":1,"width":"8","height":"6","format":"<img src={{msg.payload}}>","storeOutMessages":true,"fwdInMessages":false,"resendOnRefresh":true,"templateScope":"local","className":"","x":1510,"y":280,"wires":[[]]},{"id":"e2162245.83705","type":"exec","z":"200cf880.993108","command":"","addpay":"payload","append":"","useSpawn":"true","timer":"","oldrc":false,"name":"FFMPEG","x":800,"y":160,"wires":[["385069d4.9fd426"],[],[]]},{"id":"f6627e1a.dd477","type":"exec","z":"200cf880.993108","command":"","addpay":"payload","append":"","useSpawn":"true","timer":"","oldrc":false,"name":"FFMPEG","x":800,"y":260,"wires":[["385069d4.9fd426"],[],[]]},{"id":"3fae3662.af3d5a","type":"exec","z":"200cf880.993108","command":"","addpay":"payload","append":"","useSpawn":"true","timer":"","oldrc":false,"name":"FFMPEG","x":800,"y":360,"wires":[["385069d4.9fd426"],[],[]]},{"id":"275e6fdd.fd282","type":"ui_button","z":"200cf880.993108","name":"","group":"af12f83b.c43ff8","order":2,"width":"4","height":"1","passthru":false,"label":"재생시작","tooltip":"","color":"","bgcolor":"","className":"","icon":"","payload":"ffmpeg -f rtsp -i \"rtsp://192.168.0.15:8554/mjpeg/1\" -preset slow -codec:v libx264 -pix_fmt yuv420p -b:v 2500k -minrate 1500k -maxrate 4000k -bufsize 5000k -f segment -strftime 1 -segment_time 10 -reset_timestamps 1 \"C:\\Users\\wajang\\.node-red\\root\\video\\ch2\\%Y-%m-%d-%H-%M-%S_steam2.mp4\" -f image2pipe pipe:1","payloadType":"str","topic":"stream2","topicType":"str","x":100,"y":160,"wires":[["3c401007.1d5c8"]]},{"id":"e75e1dff.75324","type":"ui_button","z":"200cf880.993108","name":"","group":"af12f83b.c43ff8","order":3,"width":"4","height":"1","passthru":false,"label":"종료","tooltip":"","color":"","bgcolor":"","className":"","icon":"","payload":"SIGTERM","payloadType":"str","topic":"topic","topicType":"msg","x":110,"y":200,"wires":[["db2e3c7e.ddd6b"]]},{"id":"d832dc30.8d697","type":"change","z":"200cf880.993108","name":"","rules":[{"t":"set","p":"kill","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":610,"y":200,"wires":[["e2162245.83705"]]},{"id":"3c401007.1d5c8","type":"function","z":"200cf880.993108","name":"msg.payload를제외한나머지를 소거","func":"var data = {\n    topic:msg.topic,\n    payload:msg.payload\n}\n\nreturn data;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":340,"y":160,"wires":[["e2162245.83705"]]},{"id":"db2e3c7e.ddd6b","type":"function","z":"200cf880.993108","name":"msg.payload를제외한나머지를 소거","func":"var data = {\n    payload:msg.payload\n}\n\nreturn data;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":340,"y":200,"wires":[["d832dc30.8d697"]]},{"id":"e77e6a00.38ed88","type":"ui_button","z":"200cf880.993108","name":"","group":"e241e0f8.2cb09","order":2,"width":"4","height":"1","passthru":false,"label":"재생시작","tooltip":"","color":"","bgcolor":"","className":"","icon":"","payload":"ffmpeg -f rtsp -i \"rtsp://192.168.0.16:8554/mjpeg/1\" -preset slow -codec:v libx264 -pix_fmt yuv420p -b:v 2500k -minrate 1500k -maxrate 4000k -bufsize 5000k -f segment -strftime 1 -segment_time 10 -reset_timestamps 1 \"C:\\Users\\wajang\\.node-red\\root\\video\\ch3\\%Y-%m-%d-%H-%M-%S_steam3.mp4\" -f image2pipe pipe:1","payloadType":"str","topic":"stream3","topicType":"str","x":100,"y":260,"wires":[["fcbb193b.7368d8"]]},{"id":"844c2970.b47608","type":"ui_button","z":"200cf880.993108","name":"","group":"e241e0f8.2cb09","order":3,"width":"4","height":"1","passthru":false,"label":"종료","tooltip":"","color":"","bgcolor":"","className":"","icon":"","payload":"SIGTERM","payloadType":"str","topic":"topic","topicType":"msg","x":110,"y":300,"wires":[["ba0da948.394db8"]]},{"id":"e54f110d.15787","type":"change","z":"200cf880.993108","name":"","rules":[{"t":"set","p":"kill","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":610,"y":300,"wires":[["f6627e1a.dd477"]]},{"id":"fcbb193b.7368d8","type":"function","z":"200cf880.993108","name":"msg.payload를제외한나머지를 소거","func":"var data = {\n    topic:msg.topic,\n    payload:msg.payload\n}\n\nreturn data;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":340,"y":260,"wires":[["f6627e1a.dd477"]]},{"id":"ba0da948.394db8","type":"function","z":"200cf880.993108","name":"msg.payload를제외한나머지를 소거","func":"var data = {\n    payload:msg.payload\n}\n\nreturn data;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":340,"y":300,"wires":[["e54f110d.15787"]]},{"id":"37f8cfb0.2da4f","type":"ui_button","z":"200cf880.993108","name":"","group":"3bf98549.5a498a","order":2,"width":"4","height":"1","passthru":false,"label":"재생시작","tooltip":"","color":"","bgcolor":"","className":"","icon":"","payload":"ffmpeg -f rtsp -i \"rtsp://wowzaec2demo.streamlock.net/vod/mp4:BigBuckBunny_115k.mp4\"  -f segment -strftime 1 -segment_time 10 -reset_timestamps 1 \"C:\\Users\\wajang\\.node-red\\root\\video\\ch4\\%Y-%m-%d-%H-%M-%S_steam4.mp4\" -f image2pipe pipe:1","payloadType":"str","topic":"stream4","topicType":"str","x":100,"y":360,"wires":[["93def611.b4c638"]]},{"id":"4129ec59.ec7044","type":"ui_button","z":"200cf880.993108","name":"","group":"3bf98549.5a498a","order":3,"width":"4","height":"1","passthru":false,"label":"종료","tooltip":"","color":"","bgcolor":"","className":"","icon":"","payload":"SIGTERM","payloadType":"str","topic":"topic","topicType":"msg","x":110,"y":400,"wires":[["1dc44d4c.d9ef23"]]},{"id":"da530559.29e898","type":"change","z":"200cf880.993108","name":"","rules":[{"t":"set","p":"kill","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":610,"y":400,"wires":[["3fae3662.af3d5a"]]},{"id":"93def611.b4c638","type":"function","z":"200cf880.993108","name":"msg.payload를제외한나머지를 소거","func":"var data = {\n    topic:msg.topic,\n    payload:msg.payload\n}\n\nreturn data;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":340,"y":360,"wires":[["3fae3662.af3d5a"]]},{"id":"1dc44d4c.d9ef23","type":"function","z":"200cf880.993108","name":"msg.payload를제외한나머지를 소거","func":"var data = {\n    payload:msg.payload\n}\n\nreturn data;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":340,"y":400,"wires":[["da530559.29e898"]]},{"id":"f6235f14.077f4","type":"switch","z":"200cf880.993108","name":"","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"stream1","vt":"str"},{"t":"eq","v":"stream2","vt":"str"},{"t":"eq","v":"stream3","vt":"str"},{"t":"eq","v":"stream4","vt":"str"}],"checkall":"true","repair":false,"outputs":4,"x":1370,"y":220,"wires":[["2ec7777b.88d278"],["21f2a45f.885b3c"],["98d82166.950b1"],["a6b3683f.8caff8"]]},{"id":"12d32f81.ab577","type":"ui_list","z":"200cf880.993108","group":"2ab41fc4.d506a","name":"","order":1,"width":4,"height":14,"lineType":"two","actionType":"click","allowHTML":false,"outputs":1,"topic":"","x":1270,"y":460,"wires":[["faa014ce.ce16e8"]]},{"id":"c7522590.a52658","type":"inject","z":"200cf880.993108","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"[\"1채널\",\"2채널\",\"3채널\",\"4채널\"]","payloadType":"json","x":1130,"y":460,"wires":[["12d32f81.ab577"]]},{"id":"2e757009.8e22f","type":"ui_template","z":"200cf880.993108","group":"2ab41fc4.d506a","name":"크게보기","order":2,"width":16,"height":14,"format":"<img src={{msg.payload}}>","storeOutMessages":true,"fwdInMessages":false,"resendOnRefresh":true,"templateScope":"local","className":"","x":1500,"y":60,"wires":[[]]},{"id":"faa014ce.ce16e8","type":"function","z":"200cf880.993108","name":"유저가선택한채널번호를 기록한다","func":"global.set(\"channel\",msg.payload.title)\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1470,"y":400,"wires":[[]]},{"id":"d5144a30.a76ee8","type":"function","z":"200cf880.993108","name":"","func":"var channel = global.get(\"channel\");\n\nif(channel == null){\n    channel = \"1채널\";\n}\n\nif(channel == \"1채널\" && msg.topic != \"stream1\") return null;\nif(channel == \"2채널\" && msg.topic != \"stream2\") return null;\nif(channel == \"3채널\" && msg.topic != \"stream3\") return null;\nif(channel == \"4채널\" && msg.topic != \"stream4\") return null;\n\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1320,"y":120,"wires":[["2e757009.8e22f"]]},{"id":"c4020e85.6cfd3","type":"function","z":"200cf880.993108","name":"","func":"for(var i = 0;i<msg.payload.length;i++){\n   msg.payload[i] = msg.payload[i].replace(\"C:\\\\Users\\\\wajang\\\\.node-red\\\\root\\\\video\\\\\",\"\");\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":490,"y":500,"wires":[["23649fff.914d"]]},{"id":"2e57a784.e34818","type":"ui_group","name":"1채널","tab":"2edd23a3.ca6a2c","order":1,"disp":true,"width":"8","collapse":false,"className":""},{"id":"deaca213.3fda1","type":"ui_group","name":"CCTV다시보기","tab":"5d3f7c24.8ddf94","order":2,"disp":true,"width":20,"collapse":false,"className":""},{"id":"af12f83b.c43ff8","type":"ui_group","name":"2채널","tab":"2edd23a3.ca6a2c","order":2,"disp":true,"width":"8","collapse":false,"className":""},{"id":"e241e0f8.2cb09","type":"ui_group","name":"3채널","tab":"2edd23a3.ca6a2c","order":3,"disp":true,"width":"8","collapse":false,"className":""},{"id":"3bf98549.5a498a","type":"ui_group","name":"4채널","tab":"2edd23a3.ca6a2c","order":4,"disp":true,"width":"8","collapse":false,"className":""},{"id":"2ab41fc4.d506a","type":"ui_group","name":"크게보기","tab":"20c2958e.cbb55a","order":1,"disp":true,"width":"20","collapse":false,"className":""},{"id":"2edd23a3.ca6a2c","type":"ui_tab","name":"녹칸다의 CCTV","icon":"dashboard","order":8,"disabled":false,"hidden":false},{"id":"5d3f7c24.8ddf94","type":"ui_tab","name":"다시보기","icon":"dashboard","order":9,"disabled":false,"hidden":false},{"id":"20c2958e.cbb55a","type":"ui_tab","name":"채널별크게보기","icon":"dashboard","order":10,"disabled":false,"hidden":false}]
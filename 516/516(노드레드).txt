[{"id":"f209512e.a485b","type":"debug","z":"7c2ee624.fb7028","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":230,"y":960,"wires":[]},{"id":"cb8d2156.b2695","type":"mqtt in","z":"7c2ee624.fb7028","name":"","topic":"nockanda/gateway","qos":"2","datatype":"auto","broker":"8f4f6e74.2997a","nl":false,"rap":true,"rh":0,"x":110,"y":140,"wires":[["a0c82e5a.abe34"]]},{"id":"a0c82e5a.abe34","type":"json","z":"7c2ee624.fb7028","name":"","property":"payload","action":"","pretty":false,"x":190,"y":360,"wires":[["fde5634a.e20e5","ade4da1e.82bfa8"]]},{"id":"780f5697.961b98","type":"ui_text","z":"7c2ee624.fb7028","group":"2e91c6de.e9a80a","order":2,"width":0,"height":0,"name":"","label":"노드ID","format":"{{msg.payload.id}}","layout":"row-spread","className":"","x":710,"y":220,"wires":[]},{"id":"de8fb574.38ce88","type":"ui_text","z":"7c2ee624.fb7028","group":"2e91c6de.e9a80a","order":3,"width":0,"height":0,"name":"","label":"온도값","format":"{{msg.payload.temp}}","layout":"row-spread","className":"","x":710,"y":260,"wires":[]},{"id":"ab71959.649c768","type":"ui_text","z":"7c2ee624.fb7028","group":"2e91c6de.e9a80a","order":4,"width":0,"height":0,"name":"","label":"습도값","format":"{{msg.payload.humi}}","layout":"row-spread","className":"","x":710,"y":300,"wires":[]},{"id":"7c21c21e.bef96c","type":"ui_text","z":"7c2ee624.fb7028","group":"2e91c6de.e9a80a","order":5,"width":0,"height":0,"name":"","label":"LED상태","format":"{{msg.payload}}","layout":"row-spread","className":"","x":900,"y":360,"wires":[]},{"id":"fde5634a.e20e5","type":"switch","z":"7c2ee624.fb7028","name":"","property":"payload.id","propertyType":"msg","rules":[{"t":"eq","v":"2","vt":"str"},{"t":"eq","v":"3","vt":"str"},{"t":"eq","v":"4","vt":"str"}],"checkall":"true","repair":false,"outputs":3,"x":310,"y":560,"wires":[["780f5697.961b98","de8fb574.38ce88","ab71959.649c768","bdd80cab.c08bf","81facdb8.bb36","f072adc6.08e3d","1f6f741f.d0475c","393d8fd3.09c98","1496a2ea.b98ced"],["b583539e.03e56","b0c62658.80f5a8","85d8fb2c.c210e8","5185e108.15aa","4f41599c.656b68","af1018c4.826d28","1c5277b7.846548","8b13d009.106a1","2a0244b3.4115cc"],[]]},{"id":"b583539e.03e56","type":"ui_text","z":"7c2ee624.fb7028","group":"57c78b8e.119224","order":1,"width":0,"height":0,"name":"","label":"노드ID","format":"{{msg.payload.id}}","layout":"row-spread","className":"","x":710,"y":760,"wires":[]},{"id":"b0c62658.80f5a8","type":"ui_text","z":"7c2ee624.fb7028","group":"57c78b8e.119224","order":2,"width":0,"height":0,"name":"","label":"온도값","format":"{{msg.payload.temp}}","layout":"row-spread","className":"","x":710,"y":800,"wires":[]},{"id":"85d8fb2c.c210e8","type":"ui_text","z":"7c2ee624.fb7028","group":"57c78b8e.119224","order":3,"width":0,"height":0,"name":"","label":"습도값","format":"{{msg.payload.humi}}","layout":"row-spread","className":"","x":710,"y":840,"wires":[]},{"id":"d7a14ed3.9cdef","type":"ui_text","z":"7c2ee624.fb7028","group":"57c78b8e.119224","order":4,"width":0,"height":0,"name":"","label":"LED상태","format":"{{msg.payload}}","layout":"row-spread","className":"","x":980,"y":920,"wires":[]},{"id":"bdd80cab.c08bf","type":"ui_gauge","z":"7c2ee624.fb7028","name":"","group":"2e91c6de.e9a80a","order":8,"width":"3","height":"3","gtype":"donut","title":"온도","label":"'C","format":"{{msg.payload.temp}}","min":"10","max":"50","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","className":"","x":710,"y":460,"wires":[]},{"id":"81facdb8.bb36","type":"ui_gauge","z":"7c2ee624.fb7028","name":"","group":"2e91c6de.e9a80a","order":8,"width":"3","height":"3","gtype":"donut","title":"습도","label":"%","format":"{{msg.payload.humi}}","min":"10","max":"50","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","className":"","x":710,"y":500,"wires":[]},{"id":"7e20578f.82be38","type":"ui_chart","z":"7c2ee624.fb7028","name":"","group":"37b8047e.89c1ec","order":10,"width":0,"height":0,"label":"온도차트","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":820,"y":540,"wires":[[]]},{"id":"d72b038b.c47f6","type":"ui_chart","z":"7c2ee624.fb7028","name":"","group":"37b8047e.89c1ec","order":10,"width":0,"height":0,"label":"습도차트","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":820,"y":580,"wires":[[]]},{"id":"f072adc6.08e3d","type":"change","z":"7c2ee624.fb7028","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.temp","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":660,"y":540,"wires":[["7e20578f.82be38"]]},{"id":"1f6f741f.d0475c","type":"change","z":"7c2ee624.fb7028","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.humi","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":660,"y":580,"wires":[["d72b038b.c47f6"]]},{"id":"393d8fd3.09c98","type":"switch","z":"7c2ee624.fb7028","name":"","property":"payload.state","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"str"},{"t":"eq","v":"1","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":590,"y":360,"wires":[["46e586c3.b45b78"],["d60ed9af.420798"]]},{"id":"46e586c3.b45b78","type":"change","z":"7c2ee624.fb7028","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"꺼짐(OFF)","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":740,"y":340,"wires":[["7c21c21e.bef96c"]]},{"id":"d60ed9af.420798","type":"change","z":"7c2ee624.fb7028","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"켜짐(ON)","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":740,"y":380,"wires":[["7c21c21e.bef96c"]]},{"id":"24ac38f2.6b48b8","type":"ui_text","z":"7c2ee624.fb7028","group":"2e91c6de.e9a80a","order":4,"width":0,"height":0,"name":"","label":"데이터수신시간","format":"{{msg.payload}}","layout":"row-spread","className":"","x":820,"y":420,"wires":[]},{"id":"1496a2ea.b98ced","type":"function","z":"7c2ee624.fb7028","name":"시간측정","func":"msg.payload = new Date().toString();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":620,"y":420,"wires":[["24ac38f2.6b48b8"]]},{"id":"5185e108.15aa","type":"switch","z":"7c2ee624.fb7028","name":"","property":"payload.state","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"str"},{"t":"eq","v":"1","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":670,"y":920,"wires":[["c8caf019.81ce"],["ee773aee.825788"]]},{"id":"c8caf019.81ce","type":"change","z":"7c2ee624.fb7028","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"꺼짐(OFF)","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":820,"y":900,"wires":[["d7a14ed3.9cdef"]]},{"id":"ee773aee.825788","type":"change","z":"7c2ee624.fb7028","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"켜짐(ON)","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":820,"y":940,"wires":[["d7a14ed3.9cdef"]]},{"id":"1edbb951.8673c7","type":"ui_text","z":"7c2ee624.fb7028","group":"57c78b8e.119224","order":5,"width":0,"height":0,"name":"","label":"데이터수신시간","format":"{{msg.payload}}","layout":"row-spread","className":"","x":880,"y":1000,"wires":[]},{"id":"4f41599c.656b68","type":"function","z":"7c2ee624.fb7028","name":"시간측정","func":"msg.payload = new Date().toString();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":680,"y":1000,"wires":[["1edbb951.8673c7"]]},{"id":"af1018c4.826d28","type":"ui_gauge","z":"7c2ee624.fb7028","name":"","group":"57c78b8e.119224","order":8,"width":"3","height":"3","gtype":"donut","title":"온도","label":"'C","format":"{{msg.payload.temp}}","min":"10","max":"50","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","className":"","x":710,"y":1040,"wires":[]},{"id":"1c5277b7.846548","type":"ui_gauge","z":"7c2ee624.fb7028","name":"","group":"57c78b8e.119224","order":8,"width":"3","height":"3","gtype":"donut","title":"습도","label":"%","format":"{{msg.payload.humi}}","min":"10","max":"50","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","className":"","x":710,"y":1080,"wires":[]},{"id":"9e39b741.508c68","type":"ui_chart","z":"7c2ee624.fb7028","name":"","group":"4a2b1283.3010bc","order":10,"width":0,"height":0,"label":"온도차트","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":820,"y":1120,"wires":[[]]},{"id":"f824210f.a8aad","type":"ui_chart","z":"7c2ee624.fb7028","name":"","group":"4a2b1283.3010bc","order":10,"width":0,"height":0,"label":"습도차트","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":820,"y":1160,"wires":[[]]},{"id":"8b13d009.106a1","type":"change","z":"7c2ee624.fb7028","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.temp","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":660,"y":1120,"wires":[["9e39b741.508c68"]]},{"id":"2a0244b3.4115cc","type":"change","z":"7c2ee624.fb7028","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.humi","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":660,"y":1160,"wires":[["f824210f.a8aad"]]},{"id":"71898508.1d92dc","type":"mysql","z":"7c2ee624.fb7028","mydb":"2f51f2aa.0979ee","name":"","x":470,"y":220,"wires":[[]]},{"id":"ade4da1e.82bfa8","type":"function","z":"7c2ee624.fb7028","name":"SQL쿼리","func":"var mydate = new Date().toString();\nmsg.topic = \"insert into lora(id,temp,humi,state,date) values(\"+msg.payload.id+\",\"+msg.payload.humi+\",\"+msg.payload.temp+\",\"+msg.payload.state+\",'\"+mydate+\"')\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":300,"y":280,"wires":[["71898508.1d92dc"]]},{"id":"e77336a0.ef1f38","type":"ui_button","z":"7c2ee624.fb7028","name":"","group":"2e91c6de.e9a80a","order":11,"width":"3","height":"1","passthru":false,"label":"NODE1 LED ON","tooltip":"","color":"","bgcolor":"","className":"","icon":"","payload":"{\"id\":2,\"control\":1}","payloadType":"str","topic":"topic","topicType":"msg","x":1230,"y":40,"wires":[["4d6ef0fe.5f06b"]]},{"id":"413ce406.a98b9c","type":"ui_button","z":"7c2ee624.fb7028","name":"","group":"2e91c6de.e9a80a","order":11,"width":"3","height":"1","passthru":false,"label":"NODE1 LED OFF","tooltip":"","color":"","bgcolor":"","className":"","icon":"","payload":"{\"id\":2,\"control\":0}","payloadType":"str","topic":"topic","topicType":"msg","x":1230,"y":80,"wires":[["4d6ef0fe.5f06b"]]},{"id":"4d6ef0fe.5f06b","type":"mqtt out","z":"7c2ee624.fb7028","name":"","topic":"nockanda/control","qos":"","retain":"","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"8f4f6e74.2997a","x":1470,"y":120,"wires":[]},{"id":"aa4584e1.d7c628","type":"ui_button","z":"7c2ee624.fb7028","name":"","group":"57c78b8e.119224","order":11,"width":"3","height":"1","passthru":false,"label":"NODE2 LED ON","tooltip":"","color":"","bgcolor":"","className":"","icon":"","payload":"{\"id\":3,\"control\":1}","payloadType":"str","topic":"topic","topicType":"msg","x":1230,"y":140,"wires":[["4d6ef0fe.5f06b"]]},{"id":"c472943f.170de8","type":"ui_button","z":"7c2ee624.fb7028","name":"","group":"57c78b8e.119224","order":11,"width":"3","height":"1","passthru":false,"label":"NODE2 LED OFF","tooltip":"","color":"","bgcolor":"","className":"","icon":"","payload":"{\"id\":3,\"control\":0}","payloadType":"str","topic":"topic","topicType":"msg","x":1230,"y":180,"wires":[["4d6ef0fe.5f06b"]]},{"id":"c6b60b5e.ec9d08","type":"ui_table","z":"7c2ee624.fb7028","group":"476a775c.11e008","name":"","order":3,"width":"10","height":"10","columns":[],"outputs":0,"cts":false,"x":330,"y":840,"wires":[]},{"id":"5aaf4e6b.8f497","type":"mysql","z":"7c2ee624.fb7028","mydb":"2f51f2aa.0979ee","name":"","x":190,"y":780,"wires":[["c6b60b5e.ec9d08","f209512e.a485b","7058e862.a32618"]]},{"id":"d035dc72.af14b","type":"ui_form","z":"7c2ee624.fb7028","name":"","label":"","group":"476a775c.11e008","order":1,"width":0,"height":0,"options":[{"label":"디바이스아이디","value":"id","type":"number","required":true,"rows":null},{"label":"조회갯수","value":"count","type":"number","required":true,"rows":null}],"formValue":{"id":"","count":""},"payload":"","submit":"조회하기","cancel":"","topic":"topic","topicType":"msg","splitLayout":"","className":"","x":130,"y":640,"wires":[["b127bccd.f63bf"]]},{"id":"b127bccd.f63bf","type":"function","z":"7c2ee624.fb7028","name":"SQL쿼리","func":"msg.topic = \"select * from lora where id=\"+msg.payload.id+\" order by num desc limit \"+msg.payload.count;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":190,"y":720,"wires":[["5aaf4e6b.8f497"]]},{"id":"7058e862.a32618","type":"function","z":"7c2ee624.fb7028","name":"차트그리기","func":"var dataset1 = {};\nvar dataset2 = {};\nvar dataset3 = {};\n\nvar y1=[]; //온도\nvar y2=[]; //습도\nvar y3=[]; //LED상태\nvar x=[];\n\nfor(var i = 0;i<msg.payload.length;i++){\n    y1.push(msg.payload[i].temp);\n    y2.push(msg.payload[i].humi);\n    y3.push(msg.payload[i].state);\n    x.push(msg.payload[i].num);\n}\n\ndataset1.payload = [{\n    series:\"\",\n    data:[y1],\n    labels:x\n    \n}];\n\ndataset2.payload = [{\n    series:\"\",\n    data:[y2],\n    labels:x\n    \n}];\n\ndataset3.payload = [{\n    series:\"\",\n    data:[y3],\n    labels:x\n    \n}];\n\nreturn [dataset1,dataset2,dataset3];\n","outputs":3,"noerr":0,"initialize":"","finalize":"","libs":[],"x":150,"y":1080,"wires":[["6b8c1417.b4d27c"],["985e83b5.90df9"],["1086c278.f45d7e"]]},{"id":"6b8c1417.b4d27c","type":"ui_chart","z":"7c2ee624.fb7028","name":"","group":"476a775c.11e008","order":2,"width":"10","height":"3","label":"온도차트","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":340,"y":1040,"wires":[[]]},{"id":"985e83b5.90df9","type":"ui_chart","z":"7c2ee624.fb7028","name":"","group":"476a775c.11e008","order":2,"width":"10","height":"3","label":"습도차트","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":340,"y":1080,"wires":[[]]},{"id":"1086c278.f45d7e","type":"ui_chart","z":"7c2ee624.fb7028","name":"","group":"476a775c.11e008","order":2,"width":"10","height":"3","label":"LED상태차트","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":350,"y":1120,"wires":[[]]},{"id":"4ba29626.1da138","type":"ui_form","z":"7c2ee624.fb7028","name":"","label":"","group":"fa63788.6040a88","order":13,"width":0,"height":0,"options":[{"label":"노드아이디","value":"id","type":"number","required":true,"rows":null},{"label":"작동유무","value":"control","type":"switch","required":true,"rows":null}],"formValue":{"id":"","control":false},"payload":"","submit":"submit","cancel":"cancel","topic":"topic","topicType":"msg","splitLayout":"","className":"","x":1090,"y":400,"wires":[["2a092649.9ec83a"]]},{"id":"496f4389.a47a2c","type":"json","z":"7c2ee624.fb7028","name":"","property":"payload","action":"","pretty":false,"x":1330,"y":320,"wires":[["4d6ef0fe.5f06b"]]},{"id":"2a092649.9ec83a","type":"function","z":"7c2ee624.fb7028","name":"데이터바꾸기","func":"if(msg.payload.control){\n    msg.payload.control = 1;\n}else{\n    msg.payload.control = 0;\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1160,"y":260,"wires":[["496f4389.a47a2c"]]},{"id":"8f4f6e74.2997a","type":"mqtt-broker","name":"","broker":"broker.mqtt-dashboard.com","port":"1883","clientid":"","usetls":false,"protocolVersion":"4","keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","birthMsg":{},"closeTopic":"","closeQos":"0","closePayload":"","closeMsg":{},"willTopic":"","willQos":"0","willPayload":"","willMsg":{},"sessionExpiry":""},{"id":"2e91c6de.e9a80a","type":"ui_group","name":"Group 1","tab":"a8c3dc2a.d66a8","order":1,"disp":true,"width":"6","collapse":false,"className":""},{"id":"57c78b8e.119224","type":"ui_group","name":"Group 1","tab":"45f33cbb.5d05a4","order":1,"disp":true,"width":6},{"id":"37b8047e.89c1ec","type":"ui_group","name":"Group 2","tab":"a8c3dc2a.d66a8","order":2,"disp":true,"width":6},{"id":"4a2b1283.3010bc","type":"ui_group","name":"Group 2","tab":"45f33cbb.5d05a4","order":2,"disp":true,"width":6},{"id":"2f51f2aa.0979ee","type":"MySQLdatabase","name":"","host":"127.0.0.1","port":"3306","db":"example516","tz":"","charset":"UTF8"},{"id":"476a775c.11e008","type":"ui_group","name":"Group 1","tab":"f6c84de7.77c7d","order":1,"disp":true,"width":10},{"id":"fa63788.6040a88","type":"ui_group","name":"Group 1","tab":"ab1db450.3a4a08","order":1,"disp":true,"width":6},{"id":"a8c3dc2a.d66a8","type":"ui_tab","name":"노드1번","icon":"dashboard","order":1,"disabled":false,"hidden":false},{"id":"45f33cbb.5d05a4","type":"ui_tab","name":"노드2번","icon":"dashboard","order":2,"disabled":false,"hidden":false},{"id":"f6c84de7.77c7d","type":"ui_tab","name":"데이터뷰어","icon":"dashboard","order":3,"disabled":false,"hidden":false},{"id":"ab1db450.3a4a08","type":"ui_tab","name":"LED종합관제실","icon":"dashboard","order":4,"disabled":false,"hidden":false}]